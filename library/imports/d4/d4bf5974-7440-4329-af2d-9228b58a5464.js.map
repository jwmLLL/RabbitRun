{"version":3,"sources":["../../../../../assets/scripts/view/assets/scripts/view/BgView.js"],"names":["UtilTool","require","Config","cc","Class","extends","Component","properties","background1","default","type","Node","background2","propPrefab","Prefab","propArr","onLoad","propLen","length","ranIndex","start","addProp","startMove","step","moveBy","stepTime","v2","stepDis","runAction","clone","parent","tag","removeAllChildren","tempArr","i","totalProp","getRandom","prop","instantiate","setPosition","screenWidth","propWidth","addChild","name","push","Math","ceil","random","update","dt","x"],"mappings":"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","file":"BgView.js","sourceRoot":"../../../../../assets/scripts/view","sourcesContent":["const UtilTool = require(\"UtilTool\");\nconst Config = require(\"Config\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        background1: {\n            default: null,\n            type: cc.Node\n        },\n\n        background2: {\n            default: null,\n            type: cc.Node\n        },\n\n        propPrefab: {\n            default: [],\n            type: cc.Prefab\n        },\n        propArr:[],\n\n    },\n    onLoad() {\n        this.propLen = this.propPrefab.length;\n        this.ranIndex = 0;\n    },\n\n    start() {\n\n        this.addProp(this.background1,0);\n        this.addProp(this.background2,1);\n    },\n\n    //开始移动背景  step  移动的步数\n    startMove(step) {\n        // UtilTool.log(step);\n        let moveBy = cc.moveBy(Config.stepTime, cc.v2(-Config.stepDis * step, 0));\n        this.background1.runAction(moveBy);\n        this.background2.runAction(moveBy.clone());\n    },\n\n    //新增道具\n    addProp(parent,tag) {\n        parent.removeAllChildren();\n       let tempArr = [];\n        for (let i = 0; i < Config.totalProp; i++) {\n            this.ranIndex = this.getRandom();\n            let prop = cc.instantiate(this.propPrefab[this.ranIndex]);\n            prop.setPosition(cc.v2(-Config.screenWidth / 2 + Config.propWidth * (i + 0.5), 0));\n            parent.addChild(prop);\n            prop.name = \"\"+this.ranIndex;\n            tempArr.push(prop);\n        }\n        this.propArr[tag] = tempArr;\n    },\n\n    getRandom() {\n        let ranIndex = Math.ceil(Math.random() * 10) % this.propLen;\n        while((this.ranIndex == 2 || this.ranIndex == 3) && (ranIndex == 2 || ranIndex == 3))  {\n            // UtilTool.log(\" \"+ranIndex);\n            ranIndex = Math.ceil(Math.random() * 10) % this.propLen;\n        }\n        return ranIndex;\n    },\n\n\n    update(dt) {\n        if (this.background1.x <= -Config.screenWidth) {\n            this.addProp(this.background1,1);\n            // UtilTool.log(this.background1.x);\n            this.background1.x = this.background2.x + Config.screenWidth;\n        }\n        if (this.background2.x <= -Config.screenWidth) {\n            this.addProp(this.background2,1);\n            this.background2.x = this.background1.x + Config.screenWidth;\n            // UtilTool.log(\"this.background2.x = \"+this.background2.x);\n        }\n    },\n});\n"]}