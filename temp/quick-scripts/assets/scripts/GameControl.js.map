{"version":3,"sources":["GameControl.js"],"names":["PropEnum","require","cc","Class","extends","Component","properties","bgNode","default","type","Node","playerNode","gameOver","start","bgMove","getComponent","player","active","UtilTool","log","rabbit","getBoundingBoxToWorld","propArr","startUpdate","schedule","updateCollision","bind","btnClickEvent","event","customData","console","startMove","rabbitJump","len1","length","len2","i","j","item","intersects","judgeCollision","tag","parseInt","name","stone","wood","rottenWood","unscheduleAllCallbacks","null"],"mappings":"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","file":"GameControl.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["import UtilTool from \"./util/UtilTool\";\n\nconst PropEnum = require(\"PropEnum\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        bgNode: {\n            default: null,\n            type: cc.Node\n        },\n        playerNode: {\n            default: null,\n            type: cc.Node\n        },\n        gameOver: {\n            default: null,\n            type: cc.Node\n        }\n\n    },\n\n    start() {\n        this.bgMove = this.bgNode.getComponent(\"BgView\");\n        this.player = this.playerNode.getComponent(\"Player\");\n\n        this.gameOver.active = false;\n\n        UtilTool.log(\"this.player.rabbit.getBoundingBoxToWorld()   \" + this.player.rabbit.getBoundingBoxToWorld());\n        UtilTool.log(\"this.bgMove.propArr[i][j]   \" + this.bgMove.propArr[0][4].getBoundingBoxToWorld());\n\n    },\n\n    startUpdate() {\n        this.schedule(this.updateCollision.bind(this), 0.4);\n    },\n\n\n    btnClickEvent: function (event, customData) {\n        console.log(\" GameControl customData : \" + customData);\n        switch (customData) {\n            case 'jump_1':\n                this.bgMove.startMove(1);\n                break;\n            case 'jump_2':\n                this.bgMove.startMove(2);\n                break;\n        }\n        this.player.rabbitJump(1);\n\n\n        // return new Promise(function (resolve,reject) {\n        //     if (true){\n        //         resolve(value);\n        //     }else {\n        //         reject(value);\n        //     }\n        // })\n    },\n\n    updateCollision() {\n        let len1 = this.bgMove.propArr.length;\n        let len2 = this.bgMove.propArr[0].length;\n\n        for (let i = 0; i < len1; i++) {\n            for (let j = 0; j < len2; j++) {\n                let item = this.bgMove.propArr[i][j];\n                if (this.player.rabbit.getBoundingBoxToWorld().intersects(item.getBoundingBoxToWorld())) {\n                    // UtilTool.log(\" item 22222   tag  : \" + item.name);\n                    this.judgeCollision(item);\n                }\n            }\n        }\n    },\n\n    judgeCollision(item) {\n        let tag = parseInt(item.name);\n        UtilTool.log(\"PropEnum.stone  \" + PropEnum.stone)\n        switch (tag) {\n            case PropEnum.stone:\n\n                break;\n            case PropEnum.wood:\n\n                break;\n            case PropEnum.rottenWood:\n                UtilTool.log(\"碰到朽木\");\n                this.unscheduleAllCallbacks();\n                this.gameOver.active = true;\n                break;\n            case PropEnum.null:\n                UtilTool.log(\"碰到空的\");\n                this.unscheduleAllCallbacks();\n                this.gameOver.active = true;\n                break;\n        }\n    }\n});\n"]}