{"version":3,"sources":["BgView.js"],"names":["UtilTool","require","Config","cc","Class","extends","Component","properties","background1","default","type","Node","background2","propPrefab","Prefab","propArr","onLoad","propLen","length","ranIndex","isStart","start","initProp","addProp","startMove","step","moveBy","stepTime","v2","stepDis","runAction","clone","parent","tag","removeAllChildren","tempArr","i","totalProp","getRandom","prop","instantiate","setPosition","screenWidth","propWidth","addChild","name","push","Math","ceil","random","update","dt","x"],"mappings":"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","file":"BgView.js","sourceRoot":"../../../../../assets/scripts/view","sourcesContent":["const UtilTool = require(\"UtilTool\");\nconst Config = require(\"Config\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        background1: {\n            default: null,\n            type: cc.Node\n        },\n\n        background2: {\n            default: null,\n            type: cc.Node\n        },\n\n        propPrefab: {\n            default: [],\n            type: cc.Prefab\n        },\n        propArr: [],\n\n    },\n    onLoad() {\n        this.propLen = this.propPrefab.length;\n        this.ranIndex = 0;\n        this.isStart = true;\n    },\n\n    start() {\n\n\n    },\n    initProp() {\n        this.addProp(this.background1,0);\n        this.addProp(this.background2,1);\n    },\n    //开始移动背景  step  移动的步数\n    startMove(step) {\n        // UtilTool.log(step);\n        let moveBy = cc.moveBy(Config.stepTime, cc.v2(-Config.stepDis * step, 0));\n        this.background1.runAction(moveBy);\n        this.background2.runAction(moveBy.clone());\n    },\n\n    //新增道具\n    addProp(parent, tag) {\n        parent.removeAllChildren();\n        let tempArr = [];\n        for (let i = 0; i < Config.totalProp; i++) {\n            this.ranIndex = this.getRandom();\n            let prop = cc.instantiate(this.propPrefab[this.ranIndex]);\n            prop.setPosition(cc.v2(-Config.screenWidth / 2 + Config.propWidth * (i + 0.5), 0));\n            parent.addChild(prop);\n            prop.name = \"\" + this.ranIndex;\n            tempArr.push(prop);\n        }\n        this.propArr[tag] = tempArr;\n    },\n\n    getRandom() {\n        let ranIndex = Math.ceil(Math.random() * 10) % this.propLen;\n        while ((this.ranIndex == 2 || this.ranIndex == 3) && (ranIndex == 2 || ranIndex == 3)) {\n            // UtilTool.log(\" \"+ranIndex);\n            ranIndex = Math.ceil(Math.random() * 10) % this.propLen;\n        }\n        return ranIndex;\n    },\n\n\n    update(dt) {\n        if (this.background1.x <= -Config.screenWidth) {\n            this.addProp(this.background1, 1);\n            // UtilTool.log(this.background1.x);\n            this.background1.x = this.background2.x + Config.screenWidth;\n        }\n        if (this.background2.x <= -Config.screenWidth) {\n            this.addProp(this.background2, 1);\n            this.background2.x = this.background1.x + Config.screenWidth;\n            // UtilTool.log(\"this.background2.x = \"+this.background2.x);\n        }\n    },\n});\n"]}